<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GTTS</title>
  <meta name="description" content="GTTS: Vehicle ‚Ä¢ Navigator ‚Ä¢ Tolls ‚Ä¢ Fuel ‚Ä¢ Hotels ‚Ä¢ Nearby" />

  <style>
    :root{
      --bg:#0b1220;
      --panel:#020617;
      --panel2:#0a1020;
      --border:#1e293b;
      --text:#e5e7eb;
      --muted:#94a3b8;
      --brand1:#0ea5e9;
      --brand2:#2563eb;
      --shadow:0 12px 30px rgba(0,0,0,.35);

      /* warm icon palette */
      --warm1:#f59e0b; /* amber */
      --warm2:#fb7185; /* rose */
      --warm3:#fbbf24; /* yellow */
      --warm4:#fdba74; /* orange */
      --warm5:#f97316; /* orange strong */
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
      background:var(--bg);
      color:var(--text);
    }

    .topbar{
      position:sticky; top:0; z-index:20;
      display:flex; align-items:center; gap:12px;
      padding:12px 14px;
      background:linear-gradient(135deg,var(--brand1),var(--brand2));
    }
    .iconbtn{
      border:1px solid rgba(255,255,255,.25);
      background:rgba(2,6,23,.25);
      color:var(--text);
      border-radius:10px;
      padding:10px 12px;
      cursor:pointer;
      font-weight:900;
    }
    .brand{display:flex; flex-direction:column; gap:2px}
    .logo{font-weight:1000; letter-spacing:.8px; font-size:20px}
    .subtitle{font-size:12px; opacity:.9}

    .right{margin-left:auto; display:flex; align-items:center; gap:10px}
    .select{
      background:rgba(2,6,23,.35);
      color:var(--text);
      border:1px solid rgba(255,255,255,.25);
      border-radius:10px;
      padding:10px 10px;
      font-weight:800;
      max-width:280px;
    }
    .btn{
      border:1px solid rgba(255,255,255,.25);
      background:rgba(2,6,23,.25);
      color:var(--text);
      border-radius:10px;
      padding:10px 12px;
      cursor:pointer;
      font-weight:900;
    }
    .btnGhost{
      border:1px solid rgba(148,163,184,.35);
      background:transparent;
      color:var(--text);
      border-radius:10px;
      padding:8px 10px;
      cursor:pointer;
      font-weight:900;
    }

    .main{padding:16px}
    .grid{
      display:grid;
      grid-template-columns: 1.1fr 1fr;
      gap:16px;
      max-width:1200px;
      margin:0 auto;
    }
    .card{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:16px;
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .cardHeader{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:14px 14px 10px;
      border-bottom:1px solid rgba(30,41,59,.7);
    }
    .cardTitle{font-weight:1000; font-size:16px}
    .pill{
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.35);
      color:var(--muted);
      font-weight:900;
      font-size:12px;
      white-space:nowrap;
    }

    .map{
      height:520px;
      background:var(--panel2);
      position:relative;
    }
    .mapPlaceholder{
      position:absolute; inset:0;
      display:flex; flex-direction:column;
      align-items:center; justify-content:center;
      gap:10px;
      padding:16px;
      text-align:center;
      color:var(--muted);
    }
    .mapBig{font-size:42px}
    .mapText{max-width:480px}

    .mapBar{
      display:flex; gap:10px; align-items:center;
      padding:10px 14px;
      border-top:1px solid rgba(30,41,59,.7);
    }
    .small{font-size:12px; color:var(--muted)}
    .mono{font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}

    .view{padding:14px}
    .sectionTitle{font-weight:1000; font-size:18px; margin:0 0 10px}
    .hr{height:1px; background:rgba(30,41,59,.7); margin:14px 0}
    .list{display:flex; flex-direction:column; gap:10px}
    .item{
      border:1px solid rgba(30,41,59,.9);
      border-radius:14px;
      padding:12px;
      background:rgba(2,6,23,.35);
    }
    .itemTop{display:flex; justify-content:space-between; gap:10px; align-items:flex-start}
    .itemTitle{font-weight:1000}
    .itemSub{color:var(--muted); font-size:12px; margin-top:6px}
    .badge{
      border:1px solid rgba(56,189,248,.5);
      color:#bfe8ff;
      padding:4px 8px;
      border-radius:999px;
      font-size:12px;
      font-weight:900;
      white-space:nowrap;
    }
    .row{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
    .chip{
      border:1px solid rgba(148,163,184,.3);
      color:var(--text);
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      font-weight:900;
    }

    .field{
      display:grid;
      grid-template-columns: 190px 1fr;
      gap:10px;
      align-items:center;
      margin:10px 0;
    }
    .label{color:var(--muted); font-size:12px; font-weight:900}
    .input{
      width:100%;
      background:rgba(2,6,23,.5);
      color:var(--text);
      border:1px solid rgba(148,163,184,.25);
      border-radius:10px;
      padding:10px 10px;
      font-weight:900;
      outline:none;
    }
    select.input{appearance:auto}

    .hint{color:var(--muted); font-size:12px; margin-top:8px}

    .footer{
      max-width:1200px;
      margin:14px auto 0;
      display:flex; justify-content:space-between;
      gap:12px;
      padding:10px 6px;
      color:var(--muted);
    }

    .drawer{
      position:fixed; top:0; left:0; height:100%;
      width:320px;
      background:rgba(2,6,23,.98);
      border-right:1px solid var(--border);
      transform:translateX(-110%);
      transition:transform .2s ease;
      z-index:60;
      display:flex; flex-direction:column;
    }
    .drawer.open{transform:translateX(0)}
    .drawerHeader{
      display:flex; justify-content:space-between; align-items:center;
      padding:14px;
      border-bottom:1px solid rgba(30,41,59,.7);
    }
    .drawerTitle{font-weight:1000; font-size:18px}
    .nav{padding:12px; display:flex; flex-direction:column; gap:10px}
    .navItem{
      width:100%;
      text-align:left;
      border:1px solid rgba(30,41,59,.9);
      background:rgba(2,6,23,.35);
      color:var(--text);
      border-radius:14px;
      padding:12px;
      cursor:pointer;
      font-weight:1000;
    }
    .navItem.active{border-color: rgba(56,189,248,.9)}
    .drawerFooter{
      margin-top:auto;
      padding:12px 14px;
      border-top:1px solid rgba(30,41,59,.7);
    }
    .backdrop{
      position:fixed; inset:0;
      background:rgba(0,0,0,.55);
      z-index:50;
      display:none;
    }
    .backdrop.show{display:block}

    .toast{
      position:fixed; left:50%; bottom:18px;
      transform:translateX(-50%);
      background:rgba(2,6,23,0.92);
      border:1px solid rgba(148,163,184,.35);
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      font-weight:900;
      font-size:13px;
      max-width:92vw;
      box-shadow:var(--shadow);
      z-index:9999;
      opacity:0;
      pointer-events:none;
      transition:opacity .15s ease;
    }
    .toast.show{opacity:1}

    /* Custom vehicle type dropdown with images */
    .vtypeWrap{position:relative}
    .vtypeBtn{
      width:100%;
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      padding:10px 10px;
      border-radius:10px;
      border:1px solid rgba(148,163,184,.25);
      background:rgba(2,6,23,.5);
      color:var(--text);
      cursor:pointer;
      font-weight:900;
      text-align:left;
    }
    .vtypeLeft{display:flex; align-items:center; gap:10px; min-width:0}
    .vtypeIcon{
      width:34px; height:34px;
      flex:0 0 auto;
      border-radius:10px;
      border:1px solid rgba(148,163,184,.18);
      background:rgba(255,255,255,.02);
      display:flex; align-items:center; justify-content:center;
      overflow:hidden;
    }
    .vtypeLabel{white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
    .vtypeChevron{opacity:.8}
    .vtypePanel{
      position:absolute;
      z-index:30;
      top:calc(100% + 8px);
      left:0; right:0;
      background:rgba(2,6,23,.98);
      border:1px solid rgba(30,41,59,.9);
      border-radius:14px;
      box-shadow:var(--shadow);
      padding:8px;
      max-height:320px;
      overflow:auto;
      display:none;
    }
    .vtypePanel.open{display:block}
    .vtypeGroup{
      padding:8px 8px 6px;
      color:var(--muted);
      font-weight:1000;
      font-size:12px;
      text-transform:uppercase;
      letter-spacing:.06em;
    }
    .vtypeItem{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid rgba(148,163,184,.12);
      background:rgba(2,6,23,.35);
      cursor:pointer;
      margin:6px 0;
    }
    .vtypeItem:hover{border-color: rgba(56,189,248,.6)}
    .vtypeMeta{display:flex; flex-direction:column; gap:2px; min-width:0}
    .vtypeCode{font-weight:1000}
    .vtypeDesc{font-size:12px; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis}

    @media (max-width: 980px){
      .grid{grid-template-columns:1fr}
      .map{height:420px}
      .field{grid-template-columns: 1fr}
    }
  </style>
</head>

<body>
  <header class="topbar">
    <button id="btnMenu" class="iconbtn" aria-label="Open menu">‚ò∞</button>

    <div class="brand">
      <div class="logo">GTTS</div>
      <div class="subtitle">Vehicle ‚Ä¢ Navigator ‚Ä¢ Tolls ‚Ä¢ Fuel ‚Ä¢ Hotels ‚Ä¢ Nearby</div>
    </div>

    <div class="right">
      <select id="lang" class="select" aria-label="Language"></select>
      <button id="btnLocate" class="btn">üìç <span id="tLocate">–ì–µ–æ–ª–æ–∫–∞—Ü—ñ—è</span></button>
    </div>
  </header>

  <aside id="drawer" class="drawer" aria-hidden="true">
    <div class="drawerHeader">
      <div class="drawerTitle">GTTS</div>
      <button id="btnClose" class="iconbtn" aria-label="Close menu">‚úï</button>
    </div>

    <nav class="nav">
      <button class="navItem" data-route="vehicle">üöó <span id="tNavVehicle">–ê–≤—Ç–æ–º–æ–±—ñ–ª—å</span></button>
      <button class="navItem" data-route="navigator">üß≠ <span id="tNavNav">–ù–∞–≤—ñ–≥–∞—Ç–æ—Ä</span></button>
      <button class="navItem" data-route="tolls">üõ£Ô∏è <span id="tNavTolls">–û–ø–ª–∞—Ç–∞ –¥–æ—Ä—ñ–≥</span></button>
      <button class="navItem" data-route="fuel">‚õΩ <span id="tNavFuel">–ó–∞–ø—Ä–∞–≤–∫–∞</span></button>
      <button class="navItem" data-route="hotels">üè® <span id="tNavHotels">–ì–æ—Ç–µ–ª—ñ</span></button>
      <button class="navItem" data-route="nearby">üìå <span id="tNavNearby">–ú—ñ—Å—Ü—è –ø–æ—Ä—É—á</span></button>
    </nav>

    <div class="drawerFooter">
      <div class="small" id="tDrawerNote">MVP –¥–µ–º–æ (–±–µ–∑ —Ä–µ–∞–ª—å–Ω–∏—Ö –æ–ø–ª–∞—Ç).</div>
    </div>
  </aside>

  <div id="backdrop" class="backdrop"></div>

  <main class="main">
    <section class="grid">
      <div class="card">
        <div class="cardHeader">
          <div class="cardTitle" id="tMapTitle">–ú–∞–ø–∞</div>
          <div class="pill" id="pillStatus">Demo</div>
        </div>

        <div class="map">
          <div class="mapPlaceholder">
            <div class="mapBig">üó∫Ô∏è</div>
            <div class="mapText" id="tMapPlaceholder">
              –ó–∞–≥–ª—É—à–∫–∞ –º–∞–ø–∏. –ù–∞—Ç–∏—Å–Ω–∏ ‚Äú–ì–µ–æ–ª–æ–∫–∞—Ü—ñ—è‚Äù, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–æ–∑–∏—Ü—ñ—é, —ñ –æ–±–∏—Ä–∞–π –º–æ–¥—É–ª—ñ.
            </div>
          </div>
        </div>

        <div class="mapBar">
          <span class="small" id="tCoordLabel">–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏:</span>
          <span class="mono" id="coord">‚Äî</span>
          <button id="btnShare" class="btnGhost" style="margin-left:auto;">üîó <span id="tShare">–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—å</span></button>
        </div>
      </div>

      <div class="card">
        <div class="cardHeader">
          <div class="cardTitle" id="viewTitle">‚Äî</div>
          <div class="pill" id="viewPill">MVP</div>
        </div>
        <div id="view" class="view"></div>
      </div>
    </section>

    <footer class="footer">
      <div>¬© 2026 GTTS</div>
      <div class="small" id="tDisclaimer">–ü—Ä–æ—Ç–æ—Ç–∏–ø. –ù–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –¥–ª—è —Ä–µ–∞–ª—å–Ω–∏—Ö –æ–ø–ª–∞—Ç.</div>
    </footer>
  </main>

  <div id="toast" class="toast"></div>

  <script>
    (function(){
      "use strict";

      function $(id){ return document.getElementById(id); }
      function $all(sel){ return Array.prototype.slice.call(document.querySelectorAll(sel)); }

      function toast(msg){
        var el = $("toast");
        el.textContent = String(msg || "");
        el.classList.add("show");
        clearTimeout(toast._t);
        toast._t = setTimeout(function(){ el.classList.remove("show"); }, 2000);
      }

      function safeGet(k){ try { return localStorage.getItem(k); } catch(e){ return null; } }
      function safeSet(k,v){ try { localStorage.setItem(k,v); } catch(e){} }

      function escapeHtml(s){
        return String(s)
          .replace(/&/g,"&amp;")
          .replace(/</g,"&lt;")
          .replace(/>/g,"&gt;")
          .replace(/"/g,"&quot;")
          .replace(/'/g,"&#039;");
      }

      var KEY_LANG = "gtts_lang";
      var KEY_POS  = "gtts_pos";
      var KEY_VEH  = "gtts_vehicle";

      var ROUTES = ["vehicle","navigator","tolls","fuel","hotels","nearby"];

      // Languages (MVP)
      var LANGS = [
        {code:"en", label:"English"},
        {code:"uk", label:"–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞"},
        {code:"ru", label:"–†—É—Å—Å–∫–∏–π"},
        {code:"pl", label:"Polski"},
        {code:"de", label:"Deutsch"},
        {code:"fr", label:"Fran√ßais"},
        {code:"es", label:"Espa√±ol"},
        {code:"it", label:"Italiano"},
        {code:"sv", label:"Svenska"},
        {code:"cs", label:"ƒåe≈°tina"},
        {code:"ro", label:"Rom√¢nƒÉ"},
        {code:"nl", label:"Nederlands"},
      ];

      // i18n
      var T = {
        en: {
          locate:"Locate", share:"Share", map:"Map",
          coord:"Coordinates:", disclaimer:"Prototype. Do not use for real payments.",
          note:"MVP demo (no real payments).",
          vehicle:"Vehicle", vehicleTitle:"Vehicle profile",
          vehicleDesc:"Vehicle parameters used for tolls, fuel and compliance.",
          nav:"Navigator", tolls:"Tolls", fuel:"Fuel", hotels:"Hotels", nearby:"Nearby",
          mapPlaceholder:"Map placeholder. Click ‚ÄúLocate‚Äù to set your position, then browse modules.",
          posUnknown:"Unknown (click Locate)",
          plate:"Plate number",
          country:"Country",
          type:"Vehicle type (EU category)",
          fuelType:"Fuel type",
          emission:"Emission class",
          axles:"Axles",
          save:"Save", reset:"Reset to demo",
          saved:"Saved", resetDone:"Reset",
          // Select placeholders
          chooseCountry:"Choose country",
          chooseFuel:"Choose fuel type",
          chooseEco:"Choose emission class",
          chooseAxles:"Choose axles",
          chooseType:"Choose vehicle type",
          // Fuel options
          fuelDiesel:"Diesel",
          fuelPetrol:"Petrol",
          fuelLPG:"LPG",
          fuelCNG:"CNG",
          fuelLNG:"LNG",
          fuelElectric:"Electric",
          fuelHybrid:"Hybrid",
          fuelHydrogen:"Hydrogen",
          // Eco options
          euro0:"Euro 0 / Pre-Euro",
          euro1:"Euro 1",
          euro2:"Euro 2",
          euro3:"Euro 3",
          euro4:"Euro 4",
          euro5:"Euro 5",
          euro6:"Euro 6",
          euro6d:"Euro 6d",
          euro6e:"Euro 6e",
          // Vehicle type group names
          groupL:"L (2/3-wheel, quadricycles)",
          groupM:"M (passenger)",
          groupN:"N (goods)",
          groupO:"O (trailers)",
          groupAgri:"T/C/R/S (agri & towed equipment)",
          // Vehicle type short descriptions
          vL:"Motorcycles / mopeds / quads",
          vM1:"Passenger car (‚â§8 seats)",
          vM2:"Bus (‚â§5t)",
          vM3:"Bus (>5t)",
          vN1:"Goods (‚â§3.5t)",
          vN2:"Goods (3.5‚Äì12t)",
          vN3:"Goods (>12t)",
          vO:"Trailer category",
          vT:"Agricultural tractor / trailer",
          // Other
          tipAxles:"Tip: for heavy trucks and combinations, axles usually 4‚Äì9."
        },
        uk: {
          locate:"–ì–µ–æ–ª–æ–∫–∞—Ü—ñ—è", share:"–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—å", map:"–ú–∞–ø–∞",
          coord:"–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏:", disclaimer:"–ü—Ä–æ—Ç–æ—Ç–∏–ø. –ù–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –¥–ª—è —Ä–µ–∞–ª—å–Ω–∏—Ö –æ–ø–ª–∞—Ç.",
          note:"MVP –¥–µ–º–æ (–±–µ–∑ —Ä–µ–∞–ª—å–Ω–∏—Ö –æ–ø–ª–∞—Ç).",
          vehicle:"–ê–≤—Ç–æ–º–æ–±—ñ–ª—å", vehicleTitle:"–ü—Ä–æ—Ñ—ñ–ª—å –∞–≤—Ç–æ–º–æ–±—ñ–ª—è",
          vehicleDesc:"–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –∞–≤—Ç–æ –¥–ª—è –æ–ø–ª–∞—Ç–∏ –¥–æ—Ä—ñ–≥, –∑–∞–ø—Ä–∞–≤–∫–∏ —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ.",
          nav:"–ù–∞–≤—ñ–≥–∞—Ç–æ—Ä", tolls:"–û–ø–ª–∞—Ç–∞ –¥–æ—Ä—ñ–≥", fuel:"–ó–∞–ø—Ä–∞–≤–∫–∞", hotels:"–ì–æ—Ç–µ–ª—ñ", nearby:"–ú—ñ—Å—Ü—è –ø–æ—Ä—É—á",
          mapPlaceholder:"–ó–∞–≥–ª—É—à–∫–∞ –º–∞–ø–∏. –ù–∞—Ç–∏—Å–Ω–∏ ‚Äú–ì–µ–æ–ª–æ–∫–∞—Ü—ñ—è‚Äù, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–æ–∑–∏—Ü—ñ—é, —ñ –æ–±–∏—Ä–∞–π –º–æ–¥—É–ª—ñ.",
          posUnknown:"–ù–µ–≤—ñ–¥–æ–º–æ (–Ω–∞—Ç–∏—Å–Ω–∏ –ì–µ–æ–ª–æ–∫–∞—Ü—ñ—è)",
          plate:"–ù–æ–º–µ—Ä",
          country:"–ö—Ä–∞—ó–Ω–∞",
          type:"–¢–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ –∑–∞—Å–æ–±—É (–Ñ–°)",
          fuelType:"–¢–∏–ø –ø–∞–ª—å–Ω–æ–≥–æ",
          emission:"–ï–∫–æ-–∫–ª–∞—Å",
          axles:"–ö—ñ–ª—å–∫—ñ—Å—Ç—å –æ—Å–µ–π",
          save:"–ó–±–µ—Ä–µ–≥—Ç–∏", reset:"–°–∫–∏–Ω—É—Ç–∏ –¥–µ–º–æ",
          saved:"–ó–±–µ—Ä–µ–∂–µ–Ω–æ", resetDone:"–°–∫–∏–Ω—É—Ç–æ",
          chooseCountry:"–û–±–µ—Ä—ñ—Ç—å –∫—Ä–∞—ó–Ω—É",
          chooseFuel:"–û–±–µ—Ä—ñ—Ç—å —Ç–∏–ø –ø–∞–ª—å–Ω–æ–≥–æ",
          chooseEco:"–û–±–µ—Ä—ñ—Ç—å –µ–∫–æ-–∫–ª–∞—Å",
          chooseAxles:"–û–±–µ—Ä—ñ—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å –æ—Å–µ–π",
          chooseType:"–û–±–µ—Ä—ñ—Ç—å —Ç–∏–ø –¢–ó",
          fuelDiesel:"–î–∏–∑–µ–ª—å",
          fuelPetrol:"–ë–µ–Ω–∑–∏–Ω",
          fuelLPG:"LPG (—Å–∫—Ä–∞–ø–ª–µ–Ω–∏–π –≥–∞–∑)",
          fuelCNG:"CNG (—Å—Ç–∏—Å–Ω–µ–Ω–∏–π –≥–∞–∑)",
          fuelLNG:"LNG (–∑—Ä—ñ–¥–∂–µ–Ω–∏–π –≥–∞–∑)",
          fuelElectric:"–ï–ª–µ–∫—Ç—Ä–æ",
          fuelHybrid:"–ì—ñ–±—Ä–∏–¥",
          fuelHydrogen:"–í–æ–¥–µ–Ω—å",
          euro0:"Euro 0 / –¥–æ-Euro",
          euro1:"Euro 1",
          euro2:"Euro 2",
          euro3:"Euro 3",
          euro4:"Euro 4",
          euro5:"Euro 5",
          euro6:"Euro 6",
          euro6d:"Euro 6d",
          euro6e:"Euro 6e",
          groupL:"L (–º–æ—Ç–æ/–º–æ–ø–µ–¥–∏/–∫–≤–∞–¥—Ä–æ—Ü–∏–∫–ª–∏)",
          groupM:"M (–ø–∞—Å–∞–∂–∏—Ä—Å—å–∫—ñ)",
          groupN:"N (–≤–∞–Ω—Ç–∞–∂–Ω—ñ)",
          groupO:"O (–ø—Ä–∏—á–µ–ø–∏)",
          groupAgri:"T/C/R/S (—Å/–≥ —Ç–∞ –ø—Ä–∏—á—ñ–ø–Ω–µ)",
          vL:"–ú–æ—Ç–æ—Ü–∏–∫–ª–∏ / –º–æ–ø–µ–¥–∏ / –∫–≤–∞–¥—Ä–æ",
          vM1:"–õ–µ–≥–∫–æ–≤–µ –∞–≤—Ç–æ (‚â§8 –º—ñ—Å—Ü—å)",
          vM2:"–ê–≤—Ç–æ–±—É—Å (‚â§5—Ç)",
          vM3:"–ê–≤—Ç–æ–±—É—Å (>5—Ç)",
          vN1:"–í–∞–Ω—Ç–∞–∂–Ω—ñ (‚â§3.5—Ç)",
          vN2:"–í–∞–Ω—Ç–∞–∂–Ω—ñ (3.5‚Äì12—Ç)",
          vN3:"–í–∞–Ω—Ç–∞–∂–Ω—ñ (>12—Ç)",
          vO:"–ö–∞—Ç–µ–≥–æ—Ä—ñ—è –ø—Ä–∏—á–µ–ø–∞",
          vT:"–°/–≥ —Ç—Ä–∞–∫—Ç–æ—Ä / –ø—Ä–∏—á—ñ–ø",
          tipAxles:"–ü—ñ–¥–∫–∞–∑–∫–∞: –¥–ª—è —Ç—è–≥–∞—á—ñ–≤/–∞–≤—Ç–æ–ø–æ—ó–∑–¥—ñ–≤ –∑–∞–∑–≤–∏—á–∞–π 4‚Äì9 –æ—Å–µ–π."
        },
        ru: {
          locate:"–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è", share:"–ü–æ–¥–µ–ª–∏—Ç—å—Å—è", map:"–ö–∞—Ä—Ç–∞",
          coord:"–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:", disclaimer:"–ü—Ä–æ—Ç–æ—Ç–∏–ø. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –æ–ø–ª–∞—Ç.",
          note:"MVP –¥–µ–º–æ (–±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –æ–ø–ª–∞—Ç).",
          vehicle:"–ê–≤—Ç–æ–º–æ–±–∏–ª—å", vehicleTitle:"–ü—Ä–æ—Ñ–∏–ª—å –∞–≤—Ç–æ–º–æ–±–∏–ª—è",
          vehicleDesc:"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¢–° –¥–ª—è –¥–æ—Ä–æ–≥, —Ç–æ–ø–ª–∏–≤–∞ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è.",
          nav:"–ù–∞–≤–∏–≥–∞—Ç–æ—Ä", tolls:"–û–ø–ª–∞—Ç–∞ –¥–æ—Ä–æ–≥", fuel:"–ó–∞–ø—Ä–∞–≤–∫–∞", hotels:"–û—Ç–µ–ª–∏", nearby:"–ú–µ—Å—Ç–∞ —Ä—è–¥–æ–º",
          mapPlaceholder:"–ó–∞–≥–ª—É—à–∫–∞ –∫–∞—Ä—Ç—ã. –ù–∞–∂–º–∏ ‚Äú–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è‚Äù, —á—Ç–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é, –∏ –≤—ã–±–∏—Ä–∞–π –º–æ–¥—É–ª–∏.",
          posUnknown:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ (–Ω–∞–∂–º–∏ –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è)",
          plate:"–ù–æ–º–µ—Ä",
          country:"–°—Ç—Ä–∞–Ω–∞",
          type:"–¢–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å—Ä–µ–¥—Å—Ç–≤–∞ (–ï–°)",
          fuelType:"–¢–∏–ø —Ç–æ–ø–ª–∏–≤–∞",
          emission:"–≠–∫–æ-–∫–ª–∞—Å—Å",
          axles:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å–µ–π",
          save:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å", reset:"–°–±—Ä–æ—Å–∏—Ç—å –¥–µ–º–æ",
          saved:"–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ", resetDone:"–°–±—Ä–æ—à–µ–Ω–æ",
          chooseCountry:"–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É",
          chooseFuel:"–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ç–æ–ø–ª–∏–≤–∞",
          chooseEco:"–í—ã–±–µ—Ä–∏—Ç–µ —ç–∫–æ-–∫–ª–∞—Å—Å",
          chooseAxles:"–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å–µ–π",
          chooseType:"–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –¢–°",
          fuelDiesel:"–î–∏–∑–µ–ª—å",
          fuelPetrol:"–ë–µ–Ω–∑–∏–Ω",
          fuelLPG:"LPG (—Å–∂–∏–∂. –≥–∞–∑)",
          fuelCNG:"CNG (—Å–∂–∞—Ç—ã–π –≥–∞–∑)",
          fuelLNG:"LNG (—Å–∂–∏–∂–µ–Ω–Ω—ã–π –≥–∞–∑)",
          fuelElectric:"–≠–ª–µ–∫—Ç—Ä–æ",
          fuelHybrid:"–ì–∏–±—Ä–∏–¥",
          fuelHydrogen:"–í–æ–¥–æ—Ä–æ–¥",
          euro0:"Euro 0 / –¥–æ-Euro",
          euro1:"Euro 1",
          euro2:"Euro 2",
          euro3:"Euro 3",
          euro4:"Euro 4",
          euro5:"Euro 5",
          euro6:"Euro 6",
          euro6d:"Euro 6d",
          euro6e:"Euro 6e",
          groupL:"L (–º–æ—Ç–æ/–º–æ–ø–µ–¥—ã/–∫–≤–∞–¥—Ä–æ—Ü–∏–∫–ª—ã)",
          groupM:"M (–ø–∞—Å—Å–∞–∂–∏—Ä—Å–∫–∏–µ)",
          groupN:"N (–≥—Ä—É–∑–æ–≤—ã–µ)",
          groupO:"O (–ø—Ä–∏—Ü–µ–ø—ã)",
          groupAgri:"T/C/R/S (—Å/—Ö –∏ –ø—Ä–∏—Ü–µ–ø–Ω–æ–µ)",
          vL:"–ú–æ—Ç–æ—Ü–∏–∫–ª—ã / –º–æ–ø–µ–¥—ã / –∫–≤–∞–¥—Ä–æ",
          vM1:"–õ–µ–≥–∫–æ–≤–æ–µ (‚â§8 –º–µ—Å—Ç)",
          vM2:"–ê–≤—Ç–æ–±—É—Å (‚â§5—Ç)",
          vM3:"–ê–≤—Ç–æ–±—É—Å (>5—Ç)",
          vN1:"–ì—Ä—É–∑–æ–≤—ã–µ (‚â§3.5—Ç)",
          vN2:"–ì—Ä—É–∑–æ–≤—ã–µ (3.5‚Äì12—Ç)",
          vN3:"–ì—Ä—É–∑–æ–≤—ã–µ (>12—Ç)",
          vO:"–ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø—Ä–∏—Ü–µ–ø–∞",
          vT:"–°/—Ö —Ç—Ä–∞–∫—Ç–æ—Ä / –ø—Ä–∏—Ü–µ–ø",
          tipAxles:"–ü–æ–¥—Å–∫–∞–∑–∫–∞: –¥–ª—è —Ç—è–≥–∞—á–µ–π/–∞–≤—Ç–æ–ø–æ–µ–∑–¥–æ–≤ –æ–±—ã—á–Ω–æ 4‚Äì9 –æ—Å–µ–π."
        }
      };

      function langNow(){ return $("lang").value || "uk"; }
      function t(key){
        var lang = langNow();
        var dict = T[lang] || T.en;
        return (dict && dict[key]) ? dict[key] : (T.en[key] || key);
      }

      // Country list: EU + UK + UA + NO + CH (you can extend)
      var COUNTRIES = [
        "AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL",
        "PL","PT","RO","SK","SI","ES","SE",
        "UA","GB","NO","CH"
      ];

      // Fuel types
      var FUEL_TYPES = [
        { code:"diesel", key:"fuelDiesel" },
        { code:"petrol", key:"fuelPetrol" },
        { code:"lpg", key:"fuelLPG" },
        { code:"cng", key:"fuelCNG" },
        { code:"lng", key:"fuelLNG" },
        { code:"electric", key:"fuelElectric" },
        { code:"hybrid", key:"fuelHybrid" },
        { code:"hydrogen", key:"fuelHydrogen" },
      ];

      // Eco classes (common)
      var ECO_CLASSES = [
        { code:"euro0", key:"euro0" },
        { code:"euro1", key:"euro1" },
        { code:"euro2", key:"euro2" },
        { code:"euro3", key:"euro3" },
        { code:"euro4", key:"euro4" },
        { code:"euro5", key:"euro5" },
        { code:"euro6", key:"euro6" },
        { code:"euro6d", key:"euro6d" },
        { code:"euro6e", key:"euro6e" },
      ];

      // Axles 2..9 (MVP)
      var AXLES = ["2","3","4","5","6","7","8","9"];

      // Warm, light SVG icons (generated here)
      function svgCar(){
        return (
          '<svg width="34" height="34" viewBox="0 0 64 64" aria-hidden="true">' +
          '<defs><linearGradient id="g1" x1="0" y1="0" x2="1" y2="1">' +
          '<stop offset="0" stop-color="var(--warm3)"/><stop offset="1" stop-color="var(--warm2)"/>' +
          '</linearGradient></defs>' +
          '<rect x="6" y="10" width="52" height="44" rx="14" fill="rgba(255,255,255,.04)" />' +
          '<path d="M16 35l6-12c1-2 3-3 5-3h10c2 0 4 1 5 3l6 12" fill="url(#g1)" opacity=".95"/>' +
          '<rect x="14" y="33" width="36" height="10" rx="5" fill="rgba(2,6,23,.55)" />' +
          '<circle cx="22" cy="45" r="5" fill="var(--warm4)"/>' +
          '<circle cx="42" cy="45" r="5" fill="var(--warm4)"/>' +
          '<rect x="24" y="24" width="16" height="6" rx="3" fill="rgba(255,255,255,.18)"/>' +
          '</svg>'
        );
      }
      function svgTruck(){
        return (
          '<svg width="34" height="34" viewBox="0 0 64 64" aria-hidden="true">' +
          '<defs><linearGradient id="g2" x1="0" y1="0" x2="1" y2="1">' +
          '<stop offset="0" stop-color="var(--warm1)"/><stop offset="1" stop-color="var(--warm5)"/>' +
          '</linearGradient></defs>' +
          '<rect x="6" y="10" width="52" height="44" rx="14" fill="rgba(255,255,255,.04)" />' +
          '<rect x="14" y="26" width="26" height="16" rx="4" fill="url(#g2)" opacity=".95"/>' +
          '<path d="M40 30h8c2 0 3 1 4 3l2 5v4H40z" fill="var(--warm2)" opacity=".9"/>' +
          '<rect x="18" y="29" width="10" height="6" rx="2" fill="rgba(255,255,255,.18)"/>' +
          '<circle cx="24" cy="45" r="4.6" fill="var(--warm4)"/>' +
          '<circle cx="44" cy="45" r="4.6" fill="var(--warm4)"/>' +
          '<circle cx="52" cy="45" r="4.6" fill="var(--warm4)"/>' +
          '</svg>'
        );
      }
      function svgBus(){
        return (
          '<svg width="34" height="34" viewBox="0 0 64 64" aria-hidden="true">' +
          '<defs><linearGradient id="g3" x1="0" y1="0" x2="1" y2="1">' +
          '<stop offset="0" stop-color="var(--warm2)"/><stop offset="1" stop-color="var(--warm3)"/>' +
          '</linearGradient></defs>' +
          '<rect x="6" y="10" width="52" height="44" rx="14" fill="rgba(255,255,255,.04)" />' +
          '<rect x="14" y="22" width="36" height="22" rx="6" fill="url(#g3)" opacity=".92"/>' +
          '<rect x="18" y="26" width="9" height="8" rx="2" fill="rgba(255,255,255,.18)"/>' +
          '<rect x="29" y="26" width="9" height="8" rx="2" fill="rgba(255,255,255,.18)"/>' +
          '<rect x="40" y="26" width="8" height="8" rx="2" fill="rgba(255,255,255,.18)"/>' +
          '<circle cx="24" cy="46" r="4.6" fill="var(--warm4)"/>' +
          '<circle cx="42" cy="46" r="4.6" fill="var(--warm4)"/>' +
          '</svg>'
        );
      }
      function svgTrailer(){
        return (
          '<svg width="34" height="34" viewBox="0 0 64 64" aria-hidden="true">' +
          '<defs><linearGradient id="g4" x1="0" y1="0" x2="1" y2="1">' +
          '<stop offset="0" stop-color="var(--warm4)"/><stop offset="1" stop-color="var(--warm1)"/>' +
          '</linearGradient></defs>' +
          '<rect x="6" y="10" width="52" height="44" rx="14" fill="rgba(255,255,255,.04)" />' +
          '<rect x="16" y="26" width="30" height="14" rx="4" fill="url(#g4)" opacity=".94"/>' +
          '<path d="M12 33h6" stroke="rgba(255,255,255,.35)" stroke-width="3" stroke-linecap="round"/>' +
          '<circle cx="24" cy="44" r="4.6" fill="var(--warm2)"/>' +
          '<circle cx="38" cy="44" r="4.6" fill="var(--warm2)"/>' +
          '</svg>'
        );
      }
      function svgMoto(){
        return (
          '<svg width="34" height="34" viewBox="0 0 64 64" aria-hidden="true">' +
          '<defs><linearGradient id="g5" x1="0" y1="0" x2="1" y2="1">' +
          '<stop offset="0" stop-color="var(--warm3)"/><stop offset="1" stop-color="var(--warm5)"/>' +
          '</linearGradient></defs>' +
          '<rect x="6" y="10" width="52" height="44" rx="14" fill="rgba(255,255,255,.04)" />' +
          '<circle cx="22" cy="44" r="6" fill="rgba(255,255,255,.06)" stroke="var(--warm4)" stroke-width="3"/>' +
          '<circle cx="44" cy="44" r="6" fill="rgba(255,255,255,.06)" stroke="var(--warm4)" stroke-width="3"/>' +
          '<path d="M22 44l10-12h8l4 6h-8l-6 6" fill="none" stroke="url(#g5)" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>' +
          '<path d="M36 30h6" stroke="rgba(255,255,255,.25)" stroke-width="3" stroke-linecap="round"/>' +
          '</svg>'
        );
      }
      function iconForType(code){
        // pick representative icons
        if (code === "M1") return svgCar();
        if (code === "M2" || code === "M3") return svgBus();
        if (code === "N1" || code === "N2" || code === "N3") return svgTruck();
        if (code === "O1" || code === "O2" || code === "O3" || code === "O4") return svgTrailer();
        if (code.indexOf("L") === 0) return svgMoto();
        // fallback
        return svgTruck();
      }

      // EU vehicle categories (codes stored as value)
      function vehicleTypes(){
        return [
          { groupKey:"groupL", items: [
            { code:"L1e", name:"L1e", descKey:"vL" },
            { code:"L2e", name:"L2e", descKey:"vL" },
            { code:"L3e", name:"L3e", descKey:"vL" },
            { code:"L4e", name:"L4e", descKey:"vL" },
            { code:"L5e", name:"L5e", descKey:"vL" },
            { code:"L6e", name:"L6e", descKey:"vL" },
            { code:"L7e", name:"L7e", descKey:"vL" },
          ]},
          { groupKey:"groupM", items: [
            { code:"M1", name:"M1", descKey:"vM1" },
            { code:"M2", name:"M2", descKey:"vM2" },
            { code:"M3", name:"M3", descKey:"vM3" },
          ]},
          { groupKey:"groupN", items: [
            { code:"N1", name:"N1", descKey:"vN1" },
            { code:"N2", name:"N2", descKey:"vN2" },
            { code:"N3", name:"N3", descKey:"vN3" },
          ]},
          { groupKey:"groupO", items: [
            { code:"O1", name:"O1", descKey:"vO" },
            { code:"O2", name:"O2", descKey:"vO" },
            { code:"O3", name:"O3", descKey:"vO" },
            { code:"O4", name:"O4", descKey:"vO" },
          ]},
          { groupKey:"groupAgri", items: [
            { code:"T", name:"T", descKey:"vT" },
            { code:"C", name:"C", descKey:"vT" },
            { code:"R", name:"R", descKey:"vT" },
            { code:"S", name:"S", descKey:"vT" },
          ]},
        ];
      }

      // Country name resolver (uses Intl.DisplayNames if available)
      function countryName(code){
        var lang = langNow();
        try {
          if (window.Intl && Intl.DisplayNames) {
            var dn = new Intl.DisplayNames([lang], { type: "region" });
            return dn.of(code) || code;
          }
        } catch(e) {}
        // fallback (minimal)
        var fallback = {
          en: { PL:"Poland", UA:"Ukraine", DE:"Germany", FR:"France", ES:"Spain", IT:"Italy", GB:"United Kingdom" },
          uk: { PL:"–ü–æ–ª—å—â–∞", UA:"–£–∫—Ä–∞—ó–Ω–∞", DE:"–ù—ñ–º–µ—á—á–∏–Ω–∞", FR:"–§—Ä–∞–Ω—Ü—ñ—è", ES:"–Ü—Å–ø–∞–Ω—ñ—è", IT:"–Ü—Ç–∞–ª—ñ—è", GB:"–í–µ–ª–∏–∫–∞ –ë—Ä–∏—Ç–∞–Ω—ñ—è" },
          ru: { PL:"–ü–æ–ª—å—à–∞", UA:"–£–∫—Ä–∞–∏–Ω–∞", DE:"–ì–µ—Ä–º–∞–Ω–∏—è", FR:"–§—Ä–∞–Ω—Ü–∏—è", ES:"–ò—Å–ø–∞–Ω–∏—è", IT:"–ò—Ç–∞–ª–∏—è", GB:"–í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è" }
        };
        var map = fallback[lang] || fallback.en;
        return map[code] || code;
      }

      // Embedded demo data (no fetch -> no 404)
      var DEMO = {
        tolls: [
          { name:"A2 Demo Segment", from:"Poznan", to:"Warsaw", country:"PL", class:"N3", axles:5, estimate:"38.5 EUR" },
          { name:"A1 Demo Segment", from:"Lodz", to:"Gdansk", country:"PL", class:"N2", axles:4, estimate:"22.0 EUR" }
        ],
        fuel: [
          { name:"FuelStop A1", brand:"PartnerX", city:"Warsaw", discount:"-8%", price:"1.54 EUR/L" },
          { name:"TruckFuel Hub", brand:"PartnerY", city:"Lodz", discount:"-6%", price:"1.49 EUR/L" },
          { name:"Highway Diesel Point", brand:"PartnerZ", city:"Poznan", discount:"-7%", price:"1.57 EUR/L" }
        ],
        hotels: [
          { name:"Truck Rest Hotel", city:"Warsaw", type:"Motel", stars:3, parking:true },
          { name:"Highway Inn", city:"Lodz", type:"Hotel", stars:4, parking:true },
          { name:"City Sleep", city:"Poznan", type:"Hotel", stars:3, parking:false }
        ],
        nearby: [
          { name:"Old Town", city:"Warsaw", category:"Sightseeing", open:true },
          { name:"Museum of Transport", city:"Lodz", category:"Museum", open:false },
          { name:"City Park", city:"Poznan", category:"Nature", open:true }
        ]
      };

      function openDrawer(){
        $("drawer").classList.add("open");
        $("drawer").setAttribute("aria-hidden","false");
        $("backdrop").classList.add("show");
      }
      function closeDrawer(){
        $("drawer").classList.remove("open");
        $("drawer").setAttribute("aria-hidden","true");
        $("backdrop").classList.remove("show");
      }

      function getPos(){
        var raw = safeGet(KEY_POS);
        if(!raw) return null;
        try { return JSON.parse(raw); } catch(e){ return null; }
      }
      function setPos(pos){
        safeSet(KEY_POS, JSON.stringify(pos));
        $("coord").textContent = pos.lat.toFixed(5)+", "+pos.lng.toFixed(5);
      }

      function locate(){
        $("pillStatus").textContent = "‚Ä¶";
        if(!navigator.geolocation){
          $("pillStatus").textContent = "Demo";
          toast("No geolocation available");
          return;
        }
        navigator.geolocation.getCurrentPosition(
          function(p){
            setPos({lat:p.coords.latitude, lng:p.coords.longitude});
            $("pillStatus").textContent = "OK";
            toast("Location set");
          },
          function(){
            $("pillStatus").textContent = "Demo";
            toast("Location denied / unavailable");
          },
          { enableHighAccuracy:true, timeout:10000, maximumAge:60000 }
        );
      }

      function shareLink(){
        var url = location.href;
        if(navigator.clipboard && navigator.clipboard.writeText){
          navigator.clipboard.writeText(url).then(function(){ toast("Copied"); })
            .catch(function(){ prompt("Copy link:", url); });
        } else {
          prompt("Copy link:", url);
        }
      }

      function getVehicle(){
        var raw = safeGet(KEY_VEH);
        if(!raw) return {
          plate:"AB1234CD",
          country:"PL",
          type:"N3",
          fuelType:"diesel",
          emission:"euro6",
          axles:"5"
        };
        try { return JSON.parse(raw); } catch(e){ return null; }
      }

      function setVehicle(v){ safeSet(KEY_VEH, JSON.stringify(v)); }

      function setActive(route){
        $all(".navItem").forEach(function(btn){
          btn.classList.toggle("active", btn.getAttribute("data-route") === route);
        });
      }

      function getRouteFromHash(){
        var h = (location.hash || "").replace("#","");
        return ROUTES.indexOf(h) >= 0 ? h : "vehicle";
      }

      function applyTexts(){
        $("tLocate").textContent = t("locate");
        $("tShare").textContent = t("share");
        $("tMapTitle").textContent = t("map");
        $("tMapPlaceholder").textContent = t("mapPlaceholder");
        $("tCoordLabel").textContent = t("coord");
        $("tDisclaimer").textContent = t("disclaimer");
        $("tDrawerNote").textContent = t("note");

        $("tNavVehicle").textContent = t("vehicle");
        $("tNavNav").textContent = t("nav");
        $("tNavTolls").textContent = t("tolls");
        $("tNavFuel").textContent = t("fuel");
        $("tNavHotels").textContent = t("hotels");
        $("tNavNearby").textContent = t("nearby");
      }

      function buildOptions(selectEl, placeholderText, items, selectedValue, labelFn){
        // items can be array of primitives or objects
        var html = "";
        html += '<option value=""' + (selectedValue ? "" : " selected") + ' disabled>' + escapeHtml(placeholderText) + '</option>';
        for (var i=0;i<items.length;i++){
          var it = items[i];
          var value = (typeof it === "string") ? it : it.code;
          var label = labelFn(it);
          var sel = (value === selectedValue) ? " selected" : "";
          html += '<option value="' + escapeHtml(value) + '"' + sel + '>' + escapeHtml(label) + '</option>';
        }
        selectEl.innerHTML = html;
      }

      // Custom vehicle type dropdown
      function renderVehicleTypePicker(containerEl, selectedCode){
        var groups = vehicleTypes();
        var selected = findVehicleType(selectedCode) || findVehicleType("N3");

        containerEl.innerHTML =
          '<div class="vtypeWrap">' +
            '<button type="button" class="vtypeBtn" id="vtypeBtn">' +
              '<div class="vtypeLeft">' +
                '<div class="vtypeIcon" id="vtypeIcon">' + iconForType(selected.code) + '</div>' +
                '<div class="vtypeLabel" id="vtypeLabel">' + escapeHtml(selected.code + " ‚Äî " + selected.desc) + '</div>' +
              '</div>' +
              '<div class="vtypeChevron">‚ñæ</div>' +
            '</button>' +
            '<div class="vtypePanel" id="vtypePanel"></div>' +
            '<input type="hidden" id="vehType" value="' + escapeHtml(selected.code) + '">' +
          '</div>';

        var panel = $("vtypePanel");
        var html = "";

        html += '<div class="vtypeGroup">' + escapeHtml(t("chooseType")) + '</div>';

        for (var g=0; g<groups.length; g++){
          html += '<div class="vtypeGroup">' + escapeHtml(t(groups[g].groupKey)) + '</div>';
          for (var j=0; j<groups[g].items.length; j++){
            var it = groups[g].items[j];
            var desc = t(it.descKey);
            html +=
              '<div class="vtypeItem" data-code="' + escapeHtml(it.code) + '">' +
                '<div class="vtypeIcon">' + iconForType(it.code) + '</div>' +
                '<div class="vtypeMeta">' +
                  '<div class="vtypeCode">' + escapeHtml(it.code) + '</div>' +
                  '<div class="vtypeDesc">' + escapeHtml(desc) + '</div>' +
                '</div>' +
              '</div>';
          }
        }

        panel.innerHTML = html;

        var btn = $("vtypeBtn");
        function closePanel(){ panel.classList.remove("open"); }
        function togglePanel(){ panel.classList.toggle("open"); }

        btn.addEventListener("click", function(e){
          e.preventDefault();
          togglePanel();
        });

        // Click outside close
        setTimeout(function(){
          document.addEventListener("click", function(e){
            var wrap = containerEl.querySelector(".vtypeWrap");
            if (!wrap) return;
            if (!wrap.contains(e.target)) closePanel();
          }, { passive: true });
        }, 0);

        // Item select
        $all("#vtypePanel .vtypeItem").forEach(function(el){
          el.addEventListener("click", function(){
            var code = el.getAttribute("data-code");
            var chosen = findVehicleType(code);
            if (!chosen) return;

            $("vehType").value = code;
            $("vtypeIcon").innerHTML = iconForType(code);
            $("vtypeLabel").textContent = chosen.code + " ‚Äî " + chosen.desc;
            closePanel();
          });
        });
      }

      function findVehicleType(code){
        var groups = vehicleTypes();
        for (var g=0; g<groups.length; g++){
          for (var i=0; i<groups[g].items.length; i++){
            var it = groups[g].items[i];
            if (it.code === code) {
              return { code: it.code, desc: t(it.descKey), groupKey: groups[g].groupKey };
            }
          }
        }
        return null;
      }

      function render(route){
        if(ROUTES.indexOf(route) < 0) route = "vehicle";
        setActive(route);

        $("viewPill").textContent = "MVP";
        $("viewTitle").textContent =
          route === "vehicle" ? t("vehicle") :
          route === "navigator" ? t("nav") :
          route === "tolls" ? t("tolls") :
          route === "fuel" ? t("fuel") :
          route === "hotels" ? t("hotels") :
          t("nearby");

        var pos = getPos();
        if(pos) $("coord").textContent = pos.lat.toFixed(5)+", "+pos.lng.toFixed(5);

        // ----- Vehicle -----
        if(route === "vehicle"){
          var v = getVehicle();
          $("view").innerHTML =
            '<h3 class="sectionTitle">'+escapeHtml(t("vehicleTitle"))+'</h3>'+
            '<div class="item">'+
              '<div class="itemSub">'+escapeHtml(t("vehicleDesc"))+'</div>'+
              '<div class="hr"></div>'+

              '<div class="field"><div class="label">'+escapeHtml(t("plate"))+'</div>'+
                '<input id="vehPlate" class="input" value="'+escapeHtml(v.plate || "")+'" placeholder="AB1234CD">'+
              '</div>'+

              '<div class="field"><div class="label">'+escapeHtml(t("country"))+'</div>'+
                '<select id="vehCountry" class="input"></select>'+
              '</div>'+

              '<div class="field"><div class="label">'+escapeHtml(t("type"))+'</div>'+
                '<div id="vehTypePicker"></div>'+
              '</div>'+

              '<div class="field"><div class="label">'+escapeHtml(t("fuelType"))+'</div>'+
                '<select id="vehFuel" class="input"></select>'+
              '</div>'+

              '<div class="field"><div class="label">'+escapeHtml(t("emission"))+'</div>'+
                '<select id="vehEmission" class="input"></select>'+
              '</div>'+

              '<div class="field"><div class="label">'+escapeHtml(t("axles"))+'</div>'+
                '<select id="vehAxles" class="input"></select>'+
              '</div>'+

              '<div class="hint">'+escapeHtml(t("tipAxles"))+'</div>'+

              '<div class="row">'+
                '<button class="btn" id="btnVehSave">üíæ '+escapeHtml(t("save"))+'</button>'+
                '<button class="btnGhost" id="btnVehReset">‚Ü∫ '+escapeHtml(t("reset"))+'</button>'+
              '</div>'+
            '</div>';

          // Build dropdowns with translated labels
          var countrySel = $("vehCountry");
          buildOptions(
            countrySel,
            t("chooseCountry"),
            COUNTRIES,
            v.country || "",
            function(code){ return countryName(code) + " (" + code + ")"; }
          );

          var fuelSel = $("vehFuel");
          buildOptions(
            fuelSel,
            t("chooseFuel"),
            FUEL_TYPES,
            v.fuelType || "",
            function(it){ return t(it.key); }
          );

          var ecoSel = $("vehEmission");
          buildOptions(
            ecoSel,
            t("chooseEco"),
            ECO_CLASSES,
            v.emission || "",
            function(it){ return t(it.key); }
          );

          var axlesSel = $("vehAxles");
          buildOptions(
            axlesSel,
            t("chooseAxles"),
            AXLES,
            v.axles || "",
            function(ax){ return ax; }
          );

          // Vehicle type custom picker with warm ‚Äúimages‚Äù
          renderVehicleTypePicker($("vehTypePicker"), v.type || "N3");

          $("btnVehSave").addEventListener("click", function(){
            var nv = {
              plate: $("vehPlate").value.trim(),
              country: ($("vehCountry").value || "").trim(),
              type: ($("vehType").value || "").trim(),          // EU code
              fuelType: ($("vehFuel").value || "").trim(),      // code
              emission: ($("vehEmission").value || "").trim(),  // code
              axles: ($("vehAxles").value || "").trim()
            };
            setVehicle(nv);
            toast(t("saved"));
          });

          $("btnVehReset").addEventListener("click", function(){
            try { localStorage.removeItem(KEY_VEH); } catch(e){}
            toast(t("resetDone"));
            render("vehicle");
          });

          return;
        }

        // ----- Navigator -----
        if(route === "navigator"){
          var posText = pos ? (pos.lat.toFixed(5)+", "+pos.lng.toFixed(5)) : t("posUnknown");
          $("view").innerHTML =
            '<h3 class="sectionTitle">'+escapeHtml(t("nav"))+'</h3>'+
            '<div class="item">'+
              '<div class="itemTitle">Best navigators (shortlist)</div>'+
              '<div class="itemSub">We will integrate multiple providers and choose best per route.</div>'+
              '<div class="row">'+
                '<span class="chip">Google Maps</span><span class="chip">Waze</span><span class="chip">HERE WeGo</span><span class="chip">TomTom</span><span class="chip">Sygic</span>'+
              '</div>'+
            '</div>'+
            '<div class="hr"></div>'+
            '<div class="item">'+
              '<div class="itemTitle">Position</div>'+
              '<div class="itemSub">'+escapeHtml(posText)+'</div>'+
              '<div class="row"><button class="btn" id="btnRouteDemo">‚ñ∂ Route demo</button></div>'+
            '</div>';

          $("btnRouteDemo").addEventListener("click", function(){ toast("Route flow (demo)"); });
          return;
        }

        // ----- Tolls -----
        if(route === "tolls"){
          var listT = DEMO.tolls.map(function(r){
            return ''+
              '<div class="item">'+
                '<div class="itemTop">'+
                  '<div>'+
                    '<div class="itemTitle">'+escapeHtml(r.name)+'</div>'+
                    '<div class="itemSub">'+escapeHtml(r.from)+' ‚Üí '+escapeHtml(r.to)+'</div>'+
                  '</div>'+
                  '<div class="badge">'+escapeHtml(r.estimate)+'</div>'+
                '</div>'+
                '<div class="row">'+
                  '<span class="chip">Class: '+escapeHtml(r.class)+'</span>'+
                  '<span class="chip">Axles: '+escapeHtml(String(r.axles))+'</span>'+
                  '<span class="chip">Country: '+escapeHtml(r.country)+'</span>'+
                '</div>'+
                '<div class="row"><button class="btn payBtn">üõ£Ô∏è '+escapeHtml(t("tolls"))+'</button></div>'+
              '</div>';
          }).join("");

          $("view").innerHTML =
            '<h3 class="sectionTitle">'+escapeHtml(t("tolls"))+'</h3>'+
            '<div class="item"><div class="itemTitle">EETS-ready (phase)</div><div class="itemSub">Demo only. Next: partner integration.</div></div>'+
            '<div class="hr"></div><div class="list">'+listT+'</div>';

          $all(".payBtn").forEach(function(b){
            b.addEventListener("click", function(){ toast("Demo payment (stub)"); });
          });
          return;
        }

        // ----- Fuel -----
        if(route === "fuel"){
          var listF = DEMO.fuel.map(function(s){
            return ''+
              '<div class="item">'+
                '<div class="itemTop">'+
                  '<div>'+
                    '<div class="itemTitle">'+escapeHtml(s.name)+'</div>'+
                    '<div class="itemSub">'+escapeHtml(s.city)+' ‚Ä¢ '+escapeHtml(s.brand)+'</div>'+
                  '</div>'+
                  '<div class="badge">'+escapeHtml(s.discount)+'</div>'+
                '</div>'+
                '<div class="row">'+
                  '<span class="chip">Price: '+escapeHtml(s.price)+'</span>'+
                  '<span class="chip">Discount system</span>'+
                '</div>'+
                '<div class="row"><button class="btn fuelBtn">‚õΩ '+escapeHtml(t("fuel"))+'</button><button class="btnGhost creditBtn">üí≥ Credit</button></div>'+
              '</div>';
          }).join("");

          $("view").innerHTML =
            '<h3 class="sectionTitle">'+escapeHtml(t("fuel"))+'</h3>'+
            '<div class="item"><div class="itemTitle">Discounted fuel</div><div class="itemSub">UTA/DKV/E100-like demo.</div></div>'+
            '<div class="hr"></div><div class="list">'+listF+'</div>';

          $all(".fuelBtn").forEach(function(b){ b.addEventListener("click", function(){ toast("Demo fuel (stub)"); }); });
          $all(".creditBtn").forEach(function(b){ b.addEventListener("click", function(){ toast("Credit (coming soon)"); }); });
          return;
        }

        // ----- Hotels -----
        if(route === "hotels"){
          var listH = DEMO.hotels.map(function(h){
            var stars = new Array((h.stars||3)+1).join("‚òÖ");
            return ''+
              '<div class="item">'+
                '<div class="itemTop">'+
                  '<div>'+
                    '<div class="itemTitle">'+escapeHtml(h.name)+'</div>'+
                    '<div class="itemSub">'+escapeHtml(h.city)+' ‚Ä¢ '+escapeHtml(h.type)+'</div>'+
                  '</div>'+
                  '<div class="badge">'+escapeHtml(stars)+'</div>'+
                '</div>'+
                '<div class="row">'+
                  '<span class="chip">Truck parking: '+(h.parking ? "Yes":"No")+'</span>'+
                  '<span class="chip">Driver rest</span>'+
                '</div>'+
                '<div class="row"><button class="btn hotelBtn">üè® '+escapeHtml(t("hotels"))+'</button></div>'+
              '</div>';
          }).join("");

          $("view").innerHTML =
            '<h3 class="sectionTitle">'+escapeHtml(t("hotels"))+'</h3>'+
            '<div class="item"><div class="itemTitle">Driver rest</div><div class="itemSub">Demo list. Next: booking API.</div></div>'+
            '<div class="hr"></div><div class="list">'+listH+'</div>';

          $all(".hotelBtn").forEach(function(b){ b.addEventListener("click", function(){ toast("Demo booking (stub)"); }); });
          return;
        }

        // ----- Nearby -----
        if(route === "nearby"){
          var listN = DEMO.nearby.map(function(p){
            return ''+
              '<div class="item">'+
                '<div class="itemTop">'+
                  '<div>'+
                    '<div class="itemTitle">'+escapeHtml(p.name)+'</div>'+
                    '<div class="itemSub">'+escapeHtml(p.category)+' ‚Ä¢ '+escapeHtml(p.city)+'</div>'+
                  '</div>'+
                  '<div class="badge">'+(p.open ? "Open":"Closed")+'</div>'+
                '</div>'+
                '<div class="row">'+
                  '<span class="chip">Tourism</span>'+
                  '<span class="chip">Near you (demo)</span>'+
                '</div>'+
                '<div class="row"><button class="btn nearBtn">üß≠ '+escapeHtml(t("nearby"))+'</button></div>'+
              '</div>';
          }).join("");

          $("view").innerHTML =
            '<h3 class="sectionTitle">'+escapeHtml(t("nearby"))+'</h3>'+
            '<div class="item"><div class="itemTitle">Places nearby</div><div class="itemSub">Demo. Next: Places API.</div></div>'+
            '<div class="hr"></div><div class="list">'+listN+'</div>';

          $all(".nearBtn").forEach(function(b){ b.addEventListener("click", function(){ toast("Demo route (stub)"); }); });
          return;
        }
      }

      function buildLangSelect(){
        var sel = $("lang");
        sel.innerHTML = "";
        for (var i=0;i<LANGS.length;i++){
          var l = LANGS[i];
          var opt = document.createElement("option");
          opt.value = l.code;
          opt.textContent = l.label;
          sel.appendChild(opt);
        }

        var saved = safeGet(KEY_LANG);
        var auto = (navigator.language || "uk").toLowerCase();
        auto = auto.indexOf("-") > -1 ? auto.split("-")[0] : auto;
        if(auto === "ua") auto = "uk";

        var initial = saved || auto || "uk";
        var has = LANGS.some(function(x){ return x.code === initial; });
        sel.value = has ? initial : "en";
      }

      function init(){
        buildLangSelect();
        applyTexts();

        var pos = getPos();
        if(pos) $("coord").textContent = pos.lat.toFixed(5)+", "+pos.lng.toFixed(5);

        $("btnMenu").addEventListener("click", openDrawer);
        $("btnClose").addEventListener("click", closeDrawer);
        $("backdrop").addEventListener("click", closeDrawer);

        $all(".navItem").forEach(function(btn){
          btn.addEventListener("click", function(){
            var route = btn.getAttribute("data-route") || "vehicle";
            closeDrawer();
            location.hash = "#"+route;
            render(route);
          });
        });

        $("btnLocate").addEventListener("click", locate);
        $("btnShare").addEventListener("click", shareLink);

        $("lang").addEventListener("change", function(e){
          safeSet(KEY_LANG, e.target.value);
          applyTexts();
          // Important: rerender current screen so dropdown labels re-translate
          render(getRouteFromHash());
        });

        window.addEventListener("hashchange", function(){
          render(getRouteFromHash());
        });

        $("pillStatus").textContent = "Demo";
        render(getRouteFromHash());
      }

      init();
    })();
  </script>
</body>
</html>
